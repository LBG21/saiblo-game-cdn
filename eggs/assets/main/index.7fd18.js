window.__require=function e(t,i,r){function n(o,s){if(!i[o]){if(!t[o]){var l=o.split("/");if(l=l[l.length-1],!t[l]){var c="function"==typeof __require&&__require;if(!s&&c)return c(l,!0);if(a)return a(l,!0);throw new Error("Cannot find module '"+o+"'")}o=l}var d=i[o]={exports:{}};t[o][0].call(d.exports,function(e){return n(t[o][1][e]||e)},d,d.exports,e,t,i,r)}return i[o].exports}for(var a="function"==typeof __require&&__require,o=0;o<r.length;o++)n(r[o]);return n}({Eggs:[function(e,t){"use strict";cc._RF.push(t,"6ebe0cy5sdAYKyk6kzLX/a7","Eggs");var i=e("./File").readFromRecordFile;cc.Class({extends:cc.Component,properties:{containerId:{default:"_filebox_container_",visible:!1},loaded:{default:!1,visible:!1},status:{default:-1,visible:!1},count:{default:0,type:cc.Integer,visible:!1},header:{default:null,type:cc.Array,visible:!1},frames:{default:null,type:cc.Array,visible:!1},Player:cc.Prefab,players:{default:[],type:[cc.Node],visible:!1},Egg:cc.Prefab,eggs:{default:[],type:[cc.Node],visible:!1},ground:{default:null,type:cc.Node},YellowImgs:{default:[],type:[cc.Texture2D]},RedImgs:{default:[],type:[cc.Texture2D]},BlueImgs:{default:[],type:[cc.Texture2D]},frameLabel:{default:null,type:cc.Node},redAI:{default:null,type:cc.Node},yellowAI:{default:null,type:cc.Node},blueAI:{default:null,type:cc.Node},speed:{default:1,visible:!1}},start:function(){cc.view.enableRetina(!0),this.readFromSaiblo()},readFromSaiblo:function(){var e=this;if(!this.loaded){if(console.log("Try reading record file..."),!window.saiblo)return console.warn("Record file not received. Retry in 500ms..."),void setTimeout(this.readFromSaiblo.bind(this),500);this.readFile(window.saiblo.replay,function(t){var r=i(t);e.header=r.header,e.frames=r.frames,e.InitGPE(),e.skipTo(),window.saiblo.confirmReplay(e.frames.length),console.log("Record file read."),e.loaded=!0}),window.saiblo.callback.loadFrame=function(t){e.skipTo(t)},window.saiblo.callback.nextFrame=function(){e.step()}}},update:function(){var e,t,i=cc.winSize,r=i.width,n=i.height,a=document.getElementById("GameCanvas");if(Math.abs(a.clientHeight-n*a.clientWidth/r)>10&&window.saiblo.resize(n/r*a.clientWidth),this.loaded){for(var o=this.frames[this.count],s=o.playerInfo,l=0;l<12;++l){var c=s[l].id,d=s[l].position,u=(s[l].eggInHand,s[l].endurance);if(this.count>0){var p=this.playerImgTrans(this.players[c].position,this.positionTrans(d[0],d[1]));-1!=p&&(this.players[c].children[0].getComponent(cc.Sprite).spriteFrame=c<4?new cc.SpriteFrame(this.RedImgs[p]):c>7?new cc.SpriteFrame(this.BlueImgs[p]):new cc.SpriteFrame(this.YellowImgs[p]))}this.players[c].position=this.positionTrans(d[0],d[1]),this.players[c].children[2].getComponent(cc.ProgressBar).progress=u/5}for(var f=o.eggInfo,g=0;g<15;++g){var h=f[g].id,m=f[g].position;f[g].score,this.eggs[h].position=this.positionTrans(m[0],m[1])}for(var y=[],v=0;v<12;++v)y.push(this.players[v]);for(var b=0;b<15;++b)y.push(this.eggs[b]);y.sort(function(e,t){return t.y-e.y});for(var w=0;w<27;++w)y[w].zIndex=w;this.frameLabel.getComponent(cc.Label).string=String(this.count);var F=null==(e=window)?void 0:null==(t=e.saiblo)?void 0:t.players;F&&(this.redAI.getComponent(cc.Label).string=F[0],this.yellowAI.getComponent(cc.Label).string=F[1],this.blueAI.getComponent(cc.Label).string=F[2])}},step:function(){++this.count},skipTo:function(e){this.count=Number.isInteger(e)?e:0},InitGPE:function(){for(var e=cc.find("Canvas"),t=0;t<12;++t)this.players.push(cc.instantiate(this.Player)),this.players[t].getChildByName("id").getComponent(cc.Label).string=String(t),this.players[t].getChildByName("img").getComponent(cc.Sprite).spriteFrame=t<4?new cc.SpriteFrame(this.RedImgs[0]):t>7?new cc.SpriteFrame(this.BlueImgs[0]):new cc.SpriteFrame(this.YellowImgs[0]),e.addChild(this.players[t]),cc.game.setFrameRate(this.header.fps);for(var i=0;i<15;++i)this.eggs.push(cc.instantiate(this.Egg)),e.addChild(this.eggs[i])},readFile:function(e,t){var i=new FileReader;i.onload=function(e){var i=e.target.result;t(i)},i.readAsArrayBuffer(e)},positionTrans:function(e,t){return e=12*e+this.ground.x+33.48,t=12*t+this.ground.y-3.5,cc.v2(e,t)},playerImgTrans:function(e,t){return e.y==t.y&&e.x==t.x?-1:Math.abs(e.y-t.y)>Math.abs(e.x-t.x)?e.y>t.y?0:1:e.x>t.x?2:3}}),cc._RF.pop()},{"./File":"File"}],File:[function(e,t){"use strict";cc._RF.push(t,"698b3HpkKxJF5ifa7ys8BOK","File");var i=15,r=12;function n(e){for(var t=e.getUint16(8,!0),r=e.getUint16(10,!0),n=e.getUint32(12,!0),a=e.getUint32(16,!0),o=e.getUint32(20,!0),s=e.getUint32(24,!0),l=e.getUint32(28,!0),c=new Date(1e3*(l*Math.pow(2,32)+s)),d=[],u=0;u<i;u++)d[u]=e.getUint8(32+u);return{frameCount:t,fps:r,redScore:n,yellowScore:a,blueScore:o,timestamp:c,eggScores:d}}function a(e,t,n){for(var a=[],o=[],s=0;s<r;s++){var l=e.getFloat32(n+120+4*s,!0),c=e.getFloat32(n+168+4*s,!0),d=e.getUint8(n+228+s);a.push({id:s,position:[l,c],eggInHand:e.getInt8(n+216+s),endurance:d/255*5})}for(var u=0;u<i;u++){var p=e.getFloat32(n+4*u,!0),f=e.getFloat32(n+60+4*u,!0);o.push({id:u,position:[p,f],score:t[u]})}return{playerInfo:a,eggInfo:o}}t.exports={readFromRecordFile:function(e){var t,i=new DataView(e);if("THAIEG"!==(t=e.slice(0,6),String.fromCharCode.apply(null,Array.from(new Uint8Array(t))))||1!==i.getUint16(6,!0))return null;for(var r=n(i),o=[],s=0,l=47;s<r.frameCount;s++,l+=240)o.push(a(i,r.eggScores,l));return{header:r,frames:o}}},cc._RF.pop()},{}]},{},["Eggs","File"]);